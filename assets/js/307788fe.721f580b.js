"use strict";(self.webpackChunkelcengine=self.webpackChunkelcengine||[]).push([[5731],{920:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>o,frontMatter:()=>c,metadata:()=>r,toc:()=>t});var i=l(4848),d=l(8453);const c={sidebar_position:25},s="Schedule",r={id:"querybuilder/schedule",title:"Schedule",description:"The Schedule method is used to schedule the execution of a query based on a given specifier. This is built on top of Robofig Cron module and supports all the cron specifiers that Robofig supports.",source:"@site/docs/querybuilder/schedule.md",sourceDirName:"querybuilder",slug:"/querybuilder/schedule",permalink:"/docs/querybuilder/schedule",draft:!1,unlisted:!1,editUrl:"https://github.com/elcengine/elcengine.github.io/tree/main/docs/docs/querybuilder/schedule.md",tags:[],version:"current",sidebarPosition:25,frontMatter:{sidebar_position:25},sidebar:"docSidebar",previous:{title:"Paginate",permalink:"/docs/querybuilder/paginate"},next:{title:"Populate",permalink:"/docs/querybuilder/populate"}},a={},t=[{value:"Usage",id:"usage",level:2},{value:"Cancelling a scheduled query",id:"cancelling-a-scheduled-query",level:2},{value:"Cancell all scheduled queries",id:"cancell-all-scheduled-queries",level:2},{value:"Handling errors",id:"handling-errors",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"schedule",children:"Schedule"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Schedule"})," method is used to schedule the execution of a query based on a given specifier. This is built on top of ",(0,i.jsx)(n.a,{href:"https://pkg.go.dev/github.com/robfig/cron/v3",children:(0,i.jsx)(n.code,{children:"Robofig Cron"})})," module and supports all the cron specifiers that ",(0,i.jsx)(n.code,{children:"Robofig"})," supports."]}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'id := WitcherModel.UpdateOne(primitive.M{"name": "Geralt"}, primitive.M{"age": 101}).Schedule("0 0 1 1 *").Exec().(int)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In the example above, we are updating the ",(0,i.jsx)(n.code,{children:"age"})," field of the Witcher document with the name ",(0,i.jsx)(n.code,{children:"Geralt"})," and scheduling the update to run on the first day of January at midnight. This example is obviously not a real-world example, but it demonstrates how to use the ",(0,i.jsx)(n.code,{children:"Schedule"})," method."]}),"\n",(0,i.jsx)(n.h2,{id:"cancelling-a-scheduled-query",children:"Cancelling a scheduled query"}),"\n",(0,i.jsxs)(n.p,{children:["To cancel a scheduled query, you can use the ",(0,i.jsx)(n.code,{children:"Cancel"})," method."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"WitcherModel.Unschedule(id)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In the example above, we are cancelling the scheduled query with the given ",(0,i.jsx)(n.code,{children:"id"})," which was returned when the query was scheduled."]}),"\n",(0,i.jsx)(n.h2,{id:"cancell-all-scheduled-queries",children:"Cancell all scheduled queries"}),"\n",(0,i.jsxs)(n.p,{children:["To cancel all scheduled queries, you can use the ",(0,i.jsx)(n.code,{children:"UnscheduleAll"})," method."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"WitcherModel.UnscheduleAll()\n"})}),"\n",(0,i.jsx)(n.p,{children:"In the example above, we are cancelling all scheduled queries."}),"\n",(0,i.jsx)(n.h2,{id:"handling-errors",children:"Handling errors"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Schedule"})," method accepts a secondary argument which is a function which will be called with the error if if the schedule execution fails or panics. This is useful for logging and knowing when a scheduled query fails."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'WitcherModel.UpdateOne(primitive.M{"name": "Geralt"}, primitive.M{"age": 101}).Schedule("0 0 1 1 *", func(err any) {\n    log.Println("Scheduled query failed:", err)\n}).Exec()\n'})})]})}function o(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,l)=>{l.d(n,{R:()=>s});var i=l(6540);const d={},c=i.createContext(d);function s(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}}}]);