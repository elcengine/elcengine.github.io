"use strict";(self.webpackChunkelcengine=self.webpackChunkelcengine||[]).push([[6523],{6739:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});var s=r(4848),i=r(8453);const l={sidebar_position:1},c="Filter Query",t={id:"plugins/filter-query",title:"Filter Query",description:"Functions which allow you to transform a specially crafted RESTful query into a MongoDB query. This middleware is extremely useful when building RESTful APIs with Elemental.",source:"@site/docs/plugins/filter-query.md",sourceDirName:"plugins",slug:"/plugins/filter-query",permalink:"/docs/plugins/filter-query",draft:!1,unlisted:!1,editUrl:"https://github.com/elcengine/elcengine.github.io/tree/main/docs/docs/plugins/filter-query.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docSidebar",previous:{title:"Plugins",permalink:"/docs/category/plugins"},next:{title:"Benchmarks",permalink:"/docs/category/benchmarks"}},d={},a=[{value:"Raw Usage",id:"raw-usage",level:2},{value:"Usage with Go Fiber",id:"usage-with-go-fiber",level:2},{value:"Usage Shortcuts",id:"usage-shortcuts",level:2},{value:"Example RESTful Queries and their MongoDB Equivalents",id:"example-restful-queries-and-their-mongodb-equivalents",level:2},{value:"Simple Queries",id:"simple-queries",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"filter-query",children:"Filter Query"}),"\n",(0,s.jsx)(n.p,{children:"Functions which allow you to transform a specially crafted RESTful query into a MongoDB query. This middleware is extremely useful when building RESTful APIs with Elemental."}),"\n",(0,s.jsx)(n.h2,{id:"raw-usage",children:"Raw Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'import (\n    "fmt"\n    "github.com/elcengine/elemental/plugins/filterquery"\n)\n\nfunc main() {\n  q := fq.Parse("?filter[name]=eq(Geralt)&filter[age]=gt(100)&sort=-name&select=name,age")\n  fmt.Println(q.Filters) // map[string]interface{}{"name": map[string]interface{}{"$eq": "Geralt"}, "age": map[string]interface{}{"$gt": 100}}\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"usage-with-go-fiber",children:"Usage with Go Fiber"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'import (\n    "github.com/gofiber/fiber/v2"\n    "github.com/elcengine/elemental/plugins/filterquery/middleware"\n)\n\nfunc main() {\n    app := fiber.New()\n\n    app.Use(fqm.NewGoFiber())\n\n    app.Get("/api/v1/witchers", func(ctx *fiber.Ctx) error {\n        q := ctx.Locals(fqm.CtxKey).(fq.Result)\n        witchers := WitcherModel.Find(q.Filters).Sort(q.Sorts).Select(q.Select).ExecTT()\n        return ctx.JSON(witchers)\n    })\n\n    app.Listen(":3000")\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"usage-shortcuts",children:"Usage Shortcuts"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"QS"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Construct an Elemental query directly from a request's query string.\nIt uses the filterquery plugin to parse the query string and apply filters, sorting, lookups, and projections to the final query."}),"\n"]}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'witchers := WitcherModel.QS("filter[name]=Geralt").ExecTT()\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"QSR"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Construct an Elemental query directly from a FilterQueryResult."}),"\n",(0,s.jsx)("br",{}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'witchers := WitcherModel.QSR(fq.Parse("filter[name]=Geralt")).ExecTT()\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"example-restful-queries-and-their-mongodb-equivalents",children:"Example RESTful Queries and their MongoDB Equivalents"}),"\n",(0,s.jsx)(n.h3,{id:"simple-queries",children:"Simple Queries"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[name]=Geralt"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Geralt"\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[name]=eq(Geralt)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "name": {\n    "$eq": "Geralt"\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[age]=gt(100)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "age": {\n    "$gt": 100\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[age]=gte(100)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "age": {\n    "$gte": 100\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[age]=lt(100)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "age": {\n    "$lt": 100\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[age]=lte(100)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "age": {\n    "$lte": 100\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[retired]=true"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "retired": true\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[retired]=false"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "retired": false\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[weapons]=in(Silver Sword,Steel Sword)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "weapons": {\n    "$in": ["Silver Sword", "Steel Sword"]\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[weapons]=nin(Silver Sword,Steel Sword)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "weapons": {\n    "$nin": ["Silver Sword", "Steel Sword"]\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[name]=reg(Geralt)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'{\n    "name": {\n        "$regex": /Geralt/\n    }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Query"}),": ",(0,s.jsx)(n.code,{children:"/api/v1/witchers?filter[school]=exists(true)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MongoDB Query"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "school": {\n    "$exists": true\n  }\n}\n'})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c});var s=r(6540);const i={},l=s.createContext(i);function c(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}}}]);